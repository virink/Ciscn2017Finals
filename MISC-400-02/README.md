# Ciscn2017Finals

## Web400 三百层

---

### First

循环加密了三百层,解压到最后第三百层是一个五年计划.exe和一个txt文本,打开是一段加密后的字符

第二百层有key.txt 提示可知加密方法为aes 
key：aesebc

使用PYG工具解密 

得到一串明显的base64编码，但直接解码并不对，根据五年计划猜测现在是第十三个五年计划,rot13解码

再解base64并转图片即可得到图片

flag在信息属性里

### BTW, Second, Maybe is 800pt

其实这道题到前面那里就该结束了
但是后来我们因为被down了题目就临时改了。
这里的flag改成了一个压缩密码 
12M的文件解压到最后只有几百K明显是有问题的。

在第一百层后可以发现文件明显变小了
这里cat进去一个压缩包提取出来用之前的flag解压得到1.666和一个mp3。
1.666是个zip，里面有三个文件，加密的。
歌名 我们的秘密 但是没有password txt或者hex打开mp3拉到最后能看到明显的一段编码，escape编码，解码的道一段文字
这里有两个解法，
1.直接把这段文字保存成txt，可以发现压缩后和TV.txt的crc是相同的，明文攻击。
2.文字是 电视剧 的 百度词条，直接our secret 解密 密码 dianshiju  得到TV.txt，同样明文攻击。

明文攻击九位大概两个小时能出来 Ginkgo123

解压后TV.txt没用了，剩下一个压缩包，一个u.doc。
压缩包注释密码十位 四位字母加六位数字。
解u.doc  hex查看可知这是个图片，大佬们都认识jpg的头，少了JFIF  加进去即可恢复图片
就是个 mdzz的表情图
得到前四位字母 后面六位数字秒出 mdzz123456

得到一个未知格式文件。说实话这个没网可能很多人都不认识，其实是bmp格式文件。
但是如果用比较强大的图片查看器改成jpg直接打开也能看到内容。
然后有一个巨大的坑点。
本来这张图是很明显的一张某电视剧的海报 但是后来把海报下半部分有剧名的地方剪掉了，要百度识图才能查到。
电视剧名字 我们的秘密，求轻打 >_< 
密码是文件名字，解出来一个jpg，是我们的队标。
可以binwalk看一下，里面其实藏了个png 
但是我把png的头去掉了。 可以通过查找IHDR定位头部，恢复一下即可。
最后一步就和firstimg的操作一样了，修改高度显示全部图片，在图片下方有flag。
至此全部结束。